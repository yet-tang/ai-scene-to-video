server:
  port: 8090

spring:
  application:
    name: ai-scene-backend
  datasource:
    # Self-hosted Postgres Connection
    url: ${SPRING_DATASOURCE_URL}
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${SPRING_DATASOURCE_PASSWORD}
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: validate # Ops Rule: Use Flyway for migration, Hibernate only validates
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
    show-sql: true
  flyway:
    enabled: true
    baseline-on-migrate: true
  servlet:
    multipart:
      max-file-size: 500MB
      max-request-size: 500MB
  
  # Self-hosted Redis Configuration
  data:
    redis:
      url: ${SPRING_REDIS_URL}

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health, info
  endpoint:
    health:
      show-details: always
      probes:
        enabled: true

logging:
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} %5p [trace_id=%X{request_id}] [user_id=%X{user_id}] --- [%15.15t] %-40.40c{1.} : %m%n"

# S3 Storage (Cloudflare R2 / AWS S3 / MinIO) Configuration
s3:
  storage:
    region: ${S3_STORAGE_REGION:auto}
    endpoint: ${S3_STORAGE_ENDPOINT}
    access-key: ${S3_STORAGE_ACCESS_KEY}
    secret-key: ${S3_STORAGE_SECRET_KEY}
    bucket: ${S3_STORAGE_BUCKET}
    public-url: ${S3_STORAGE_PUBLIC_URL}
