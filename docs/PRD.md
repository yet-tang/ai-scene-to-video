# Product Requirements Document (PRD): AI Scene to Video

## 1. Overview & Vision (概述与愿景)
**ai-scene-to-video** 旨在成为房产经纪人的“全自动制片助理”。
它通过“结构化输入 + AI 视觉理解 + 规则化生成”的流水线，解决房产经纪人“有素材、无内容、不会剪辑”的痛点。
我们的核心理念是 **“可用性优于灵活性”** —— 牺牲输入的随意性，换取输出的极高稳定性和直接发布能力，帮助单兵作战的经纪人实现“一键成片”。

## 2. Target Audience & User Personas (目标用户与画像)
*   **核心用户：** 单兵作战的房产经纪人 (Real Estate Agents)。
*   **特征：**
    *   **忙碌：** 没有时间学习复杂的剪辑软件（如 PR、剪映专业版）。
    *   **结果导向：** 关心能不能发朋友圈/抖音，能不能带来客户，不在乎技术细节。
    *   **痛点：** 手机里拍了一堆看房视频，但因为懒得剪、不会配音，最后都烂在相册里。
*   **使用场景：** 刚带完看房，坐在车里休息时，花 2 分钟上传素材，生成视频，直接发给客户或发布到短视频平台。

## 3. User Stories (用户故事)
*   **(P0)** 作为一名经纪人，我想要上传我拍摄的几段原始视频，并输入小区名和价格，系统就能自动把它们拼成一个完整的视频，配好解说和字幕，这样我就不用自己剪辑了。
*   **(P0)** 作为一名经纪人，我想要在生成视频前，确认 AI 识别的房间对不对（比如别把厕所当厨房），并能简单调整顺序，以保证视频内容的准确性。
*   **(P1)** 作为一名经纪人，我想要生成的解说词听起来像专业的房产顾问（包含采光、户型、学区等术语），而不是干巴巴的描述，这样能显得我更专业。
*   **(P2)** 作为一名经纪人，我希望整个操作流程不需要我思考，像填空题一样简单，防止我漏掉关键信息。

## 4. User Flow Diagram (用户流程图)

```mermaid
graph TD
    %% 阶段 1: 数据录入
    Start[开始: 经纪人打开应用] --> InputInfo[输入房源基础信息]
    InputInfo -->|包含: 小区名, 户型, 价格, 面积| UploadVideo[批量上传原始素材]
    
    %% 阶段 2: 预处理与识别
    UploadVideo --> AI_Process{AI 预处理 & 识别}
    AI_Process -->|Vision LLM| DetectScenes[识别场景内容: 客厅/卧室/厨卫]
    AI_Process -->|排序逻辑| SortScenes[智能排序: 门头->公区->私区]
    
    %% 阶段 3: 人工确认 (关键步骤)
    SortScenes --> ReviewUI[展示: 智能分段确认页]
    ReviewUI -->|用户操作| UserCheck{用户核对信息}
    
    UserCheck -->|发现识别错误| CorrectInfo[修正场景标签 / 调整顺序]
    CorrectInfo --> ReviewUI
    
    UserCheck -->|确认无误| GenerateScript[生成解说脚本]
    
    %% 阶段 4: 生成与发布
    GenerateScript --> ReviewScript[预览脚本 (可选微调)]
    ReviewScript -->|确认脚本| RenderVideo[合成最终视频]
    RenderVideo -->|ffmpeg/TTS| FinalOutput[输出成品短视频]
    FinalOutput --> End[下载/分享]
```

## 5. Low-Fidelity Wireframes (低保真线框图)

### 5.1. 新建项目与信息录入页 (Create & Input)
*设计目标：所见即所得的填空题，降低认知负担。*

```
--- WIREFRAME: 新建房源视频项目 ---
[ < 返回                                  下一步 > ]
|--------------------------------------------------|
|  1. 基础信息 (必填)                              |
|  [ 小区名称: 请输入小区名 (如: 阳光花园)      ]  |
|  [ 户型结构: [2] 室 [1] 厅 [1] 卫             ]  |
|  [ 建筑面积: 请输入数字 (如: 89)           ㎡ ]  |
|  [ 挂牌价格: 请输入数字 (如: 350)          万 ]  |
|--------------------------------------------------|
|  2. 核心卖点 (选填 - 帮助 AI 写出更准的文案)     |
|  ( ) 学区房    ( ) 地铁沿线    ( ) 南北通透      |
|  ( ) 急售      ( ) 全新装修    ( ) 满五唯一      |
|  [ 其他补充: 如"房东出国，看房方便"...        ]  |
|--------------------------------------------------|
|  3. 素材上传                                     |
|  [ + 点击上传视频片段 (支持多选)              ]  |
|  * 建议上传 3-5 段竖屏视频，总时长建议 < 3分钟   |
|--------------------------------------------------|
|                  [ 开始制作 ]                    |
|--------------------------------------------------|
```

### 5.2. 智能分段确认页 (Smart Review)
*设计目标：极简的“清单确认”，赋予用户掌控感，但不需要复杂操作。*

```
--- WIREFRAME: 智能分段确认 (AI 分析完成) ---
[ < 上一步                                生成视频 > ]
|--------------------------------------------------|
|  总时长: 00:45 | 风格: [标准·专业顾问] v         |
|--------------------------------------------------|
|  请确认 AI 识别的顺序与内容:                     |
|                                                  |
|  1. [ 视频缩略图 ]  00:00 - 00:05                |
|     识别场景: [ 小区大门/外立面 ] [x]            |
|     解说要点: "阳光花园，核心地段，从这里开始"   |
|     [ 拖拽排序 ]  [ 删除 ]                       |
|                                                  |
|  2. [ 视频缩略图 ]  00:05 - 00:15                |
|     识别场景: [ 客厅 ] [x]                       |
|     解说要点: "超大开间，采光无敌，南北通透"     |
|     [ 拖拽排序 ]  [ 删除 ]                       |
|                                                  |
|  3. [ 视频缩略图 ]  00:15 - 00:30                |
|     识别场景: [ 主卧 ] [x]                       |
|     解说要点: "温馨舒适，带独立飘窗"             |
|     [ 拖拽排序 ]  [ 删除 ]                       |
|                                                  |
|  [ + 添加遗漏片段 ]                              |
|--------------------------------------------------|
|  预览解说词全文:                                 |
|  "哈喽大家好，今天带大家看一套阳光花园的..."     |
|  [ 编辑文案 ]                                    |
|--------------------------------------------------|
```

## 6. Functional Requirements (功能需求)

### 6.1. 输入与预处理
1.  **结构化表单：** 系统必须提供包含小区名、户型、面积、价格的输入表单。
2.  **视频上传：** 支持用户一次性上传多个视频文件（mp4/mov），单文件大小限制在 500MB 以内。
3.  **视频转码：** 系统应自动将上传的视频统一转码为标准格式（如 1080p, h264），以便后续处理。

### 6.2. 视觉理解与分析 (Vision AI)
1.  **场景分类：** 系统必须能识别常见的房产场景：客厅、卧室、厨房、卫生间、阳台、小区环境、门头。
2.  **特征提取：** 系统应能识别画面中的关键特征（如：有落地窗、是空房还是精装、采光情况）。
3.  **信息一致性检查：** (V2版本) AI 应尝试对比“用户填写的户型”和“视频里看到的房间数”，如有明显冲突给予提示。

### 6.3. 逻辑编排与交互
1.  **智能排序：** 系统默认按照 `外景/门头 -> 客厅/餐厅 -> 厨房/卫生间 -> 卧室 -> 阳台/结尾` 的逻辑对片段进行排序，而非简单的按文件名或拍摄时间。
2.  **拖拽排序：** 用户必须能在“确认页”通过拖拽卡片来改变视频片段的播放顺序。
3.  **标签修正：** 用户必须能修改 AI 识别出的场景标签（例如将“次卧”改为“书房”）。

### 6.4. 内容生成 (GenAI)
1.  **脚本生成：** 基于 `用户输入的基础信息` + `AI 识别的画面特征` + `排序后的结构`，生成 300-500 字的解说脚本。
2.  **语音合成 (TTS)：** 提供至少一种标准的“专业房产顾问”风格的语音（沉稳、清晰、自信）。
3.  **字幕生成：** 自动生成与语音同步的字幕文件 (SRT/ASS)。

### 6.5. 视频渲染
1.  **自动剪辑：** 使用 ffmpeg 根据确认后的顺序和时长裁剪视频。
2.  **音画同步：** 确保解说词的语速与视频画面的时长大致匹配（或调整画面速度以适应语音）。
3.  **背景音乐：** 自动添加轻柔的背景音乐，并支持“人声闪避”（说话时音乐自动变小）。

## 7. Non-Functional Requirements (非功能需求)
1.  **性能 (Performance)：** 从点击“生成视频”到最终出片，时长不超过视频总时长的 2 倍（例如 1 分钟的视频，等待时间不超过 2 分钟）。
2.  **可用性 (Usability)：** “确认页”的操作步骤不超过 3 步（浏览 -> 拖拽/修改 -> 确认）。
3.  **稳定性 (Reliability)：** 视频生成成功率应 > 95%。

## 8. Success Metrics (成功指标)
1.  **核心指标：** **生成视频的可用率 (Usability Rate)** —— 用户生成后，未进行任何“重新生成”或“放弃下载”操作，直接保存/分享的比例。目标 > 70%。
2.  **效率指标：** **单片生产时间** —— 用户从打开 App 到得到成品的平均时长。目标 < 5 分钟。

## 9. Out of Scope (暂不涉及)
1.  **复杂的非线性编辑：** 不支持转场特效、滤镜调节、画中画等高级剪辑功能。
2.  **多风格选择：** MVP 版本只提供一种标准风格，不提供“激情风”、“搞笑风”等选择。
3.  **社交平台自动发布：** 用户需下载视频后自行上传到抖音/视频号，暂不对接平台 API。
